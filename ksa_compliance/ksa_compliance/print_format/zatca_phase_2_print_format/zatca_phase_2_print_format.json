{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2024-05-20 14:48:41.639065",
 "custom_format": 1,
 "default_print_language": "ar",
 "disabled": 0,
 "doc_type": "Sales Invoice",
 "docstatus": 0,
 "doctype": "Print Format",
 "font_size": 14,
 "html": "{% set seller_name, vat_registration_no, street, city, district, postal_code, enable_zatca_integration, type_of_transaction = frappe.db.get_value(\"ZATCA Business Settings\", {\"company\": doc.company}, [\"seller_name\",\"vat_registration_number\", \"street\", \"city\", \"district\", \"postal_code\", \"enable_zatca_integration\", \"type_of_business_transactions\"]) %}\n{% set inv_additional_fields_name = frappe.db.get_value('Sales Invoice Additional Fields', {\"sales_invoice\": doc.name}, \"name\") %}\n{% set setting_id = frappe.db.get_value(\"ZATCA Business Settings\", {\"company\": doc.company}, \"name\") %}\n{% set seller_commercial_reg_no = frappe.db.get_value(\"Additional Seller IDs\", {\"parent\" : setting_id, 'type_name': 'Commercial Registration Number'}, 'value') %}\n{% set inv_additional_fields = frappe.get_doc(\"Sales Invoice Additional Fields\", inv_additional_fields_name) %}\n{% set letter_head = frappe.db.get_value(\"Letter Head\", {\"is_default\": 1}, \"content\") %}\n{% set customer_commercial_reg_no = frappe.db.get_value(\"Additional Buyer IDs\", {\"parent\" : doc.customer, 'type_name': 'Commercial Registration Number'}, 'value') %}\n\n{% if seller_name and enable_zatca_integration == 1 %}\n    \n{% if (inv_additional_fields.invoice_type_transaction)[:2] == '01' %}\n    {% set invoice_type = \"Standard\" %}\n{% elif (inv_additional_fields.invoice_type_transaction)[:2] == '02' %}\n    {% set invoice_type = \"Simplified\" %}\n{% endif %}\n\n{% if letter_head %}\n<div class=\"letter-head\">\n    {{ letter_head }}\n</div>\n{% endif %}\n{% set lang = frappe[\"form_dict\"][\"_lang\"]  %}\n{% if lang == \"\u0627\u0644\u0639\u0631\u0628\u064a\u0629\" or lang == \"\u0627\u0631\u062f\u0648\" or lang == \"\u067e\u0627\u0631\u0633\u06cc\" %}\n    {% set dir = \"rtl\" %}\n{% else %}\n    {% set dir = \"ltr\" %}\n{% endif %}\n<div class=\"text-center\">\n    {% if invoice_type == \"Standard\" %}\n    {% if doc.is_return %}\n        <h2>{{_(\"Standard Tax Invoice Credit Note\")}}</h2>\n    {% elif doc.is_debit_note %}\n        <h2>{{_(\"Standard Tax Invoice Debit Note\")}}</h2>\n    {% else %}\n        <h2>{{_(\"Standard Tax Invoice\")}}</h2>\n    {% endif %}\n{% elif invoice_type == \"Simplified\" %}\n{% if doc.is_return %}\n        <h2>{{_(\"Simplified Tax Invoice Credit Note\")}}</h2>\n    {% elif doc.is_debit_note %}\n        <h2>{{_(\"Simplified Tax Invoice Debit Note\")}}</h2>\n    {% else %}\n        <h2>{{_(\"Simplified Tax Invoice\")}}</h2>\n    {% endif %}\n{% endif %}\n<div class=\"row\">\n    <div class=\"col-md-6\">\n        <span>\n            <b>{{_(\"Invoice ID\")}}</b>\n            <p>{{ doc.name }}</p>\n        </span>\n    </div>\n    <div class=\"col-md-6\">\n        <span>\n            <b>{{_(\"Posting Date\")}}</b>\n            <p>{{ doc.get_formatted(\"posting_date\") }}</p>\n        </span>\n    </div>\n</div>\n\n<hr>\n\n<table class=\"table table-bordered\" dir={{dir}}>\n        <tr>\n            <td>\n                <b>\n                    {{_(\"Seller Name\")}}\n                </b>\n            </td>\n            <td>\n                <b>\n                    {{_(\"Address\")}}\n                 </b>\n            </td>\n            <td>\n                <b>{{_(\"Vat Registration Number\")}}</b>\n            </td>\n            <td>\n                <b>{{_(\"Commercial Registration Number\")}}</b>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <p>{{ seller_name }}</p>\n            </td>\n            <td>\n                {{ street }}, {{ district }}, {{ city }} | {{ postal_code }}\n            </td>\n            <td>\n                <p>{{ vat_registration_no }}</p>\n            </td>\n            <td>\n                <p>{{ seller_commercial_reg_no }}</p>\n            </td>\n        </tr>\n</table>\n{% if invoice_type == \"Standard\" %}\n<table class=\"table table-bordered\" dir={{dir}}>\n    <tr>\n        <td>\n            <b>{{_(\"Buyer Name\")}}</b>\n        </td>\n            <td>\n                <b>{{_(\"Address\")}}</b>\n            </td>\n            <td>\n                <b>{{_(\"Vat Registration Number\")}}</b>\n            </td>\n            <td>\n                <b>{{_(\"Commercial Registration Number\")}}</b>\n            </td>\n    </tr>\n    <tr>\n        <td>\n            {{ doc.customer }}\n        </td>\n        <td>\n            {{ inv_additional_fields.buyer_street_name }}, {{ inv_additional_fields.buyer_district }},  {{ inv_additional_fields.buyer_city }}, {{ inv_additional_fields.buyer_postal_code }}\n        </td>\n        <td>\n            {{ inv_additional_fields.buyer_vat_registration_number }}\n        </td>\n        <td>\n            {{ customer_commercial_reg_no }}\n        </td>\n    </tr>\n</table>\n{% endif %}\n\n<div class='row'>\n    <div class='col-md-3 text-right'>\n\n    </div>\n    <div class='col-md-8 text-right'>\n\n    </div>\n</div>\n\n<table class=\"table table-bordered\"  dir={{dir}}>\n\t<tbody>\n\t\t<tr>\n\t\t\t<th></th>\n\t\t\t<th>{{_(\"Products\")}}</th>\n\t\t\t<th class=\"text-center\">{{_(\"Quantity\")}}</th>\n\t\t\t<th>{{_(\"Unit Price\")}}</th>\n\t\t\t<th>{{_(\"Subtotal Before Tax\")}}</th>\n\t\t\t<th class=\"text-center\">{{_(\"VAT %\")}}</th>\n\t\t\t<th class=\"text-center\">{{_(\"VAT Amount\")}}</th>\n\t\t\t<th class=\"text-center\">{{_(\"Total With VAT\")}}</th>\n\t\t</tr>\n\t\t{%- for row in doc.items -%}\n\t\t{% set item_taxes = json.loads(frappe.db.get_value(\"Sales Taxes and Charges\", {\"parent\": doc.name}, \"item_wise_tax_detail\")) %}\n        {#\n        tax_rate and tax_amount were added to sales invoice item after 0.37.1, so invoices issued before then would have zero values for them.\n        For backward compatibilty, we fall back to item wise tax details in those cases\n        #}\n\t\t{% set item_tax_percent = row.tax_rate or item_taxes[row.item_code][0] %}\n\t\t{% set item_tax_total = (row.tax_amount or item_taxes[row.item_code][1]) / doc.conversion_rate %}\n\t\t{% set item_total_after_tax = item_tax_total + row.net_amount %}\n\t\t<tr>\n\t\t\t<td style=\"width: 3%;\">{{ row.idx }}</td>\n\t\t\t<td style=\"width: 20%;\">\n\t\t\t\t{{ row.item_name }}\n\t\t\t\t{% if row.item_code != row.item_name -%}\n\t\t\t\t<br>Item Code: {{ row.item_code}}\n\t\t\t\t{%- endif %}\n\t\t\t</td>\n\t\t\t\n\t\t\t<td style=\"width: 10%; text-align: right;\">{{ row.qty | abs }}</td>\n\t\t    <td style=\"width: 15%; text-align: right;\">{{ frappe.utils.fmt_money(row.rate | abs, None, doc.currency) }}</td>\n\t\t\t<td style=\"width: 15%; text-align: right;\">{{ row.get_formatted(\"amount\", doc) }}</td>\n\t\t\t<td style=\"width: 10%; text-align: right;\">{{ item_tax_percent }} %</td>\n\t\t\t<td style=\"width: 15%; text-align: right;\">{{ frappe.utils.fmt_money(item_tax_total | abs, None, doc.currency) }}</td>\n\t\t\t<td style=\"width: 15%; text-align: right;\">{{ frappe.utils.fmt_money(item_total_after_tax | abs, None, doc.currency)}}</td>\n\t\t</tr>\n\t\t{%- endfor -%}\n\t</tbody>\n\t<div class=\"\">\n    <table class=\"table table-bordered\" dir={{dir}}>\n        <tr>\n            <td>\n                <p>{{_(\"Total Taxable Amount\")}}</p>\n            </td>\n            <td>\n                <p>{{ frappe.utils.fmt_money(doc.net_total | abs, None, doc.currency) }}</p>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <p>{{_(\"VAT Amount\")}}</p>\n            </td>\n            <td>\n                <p>{{ frappe.utils.fmt_money(doc.total_taxes_and_charges | abs, None, doc.currency) }}</p>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <p>{{_(\"Total With VAT\")}}</p>\n            </td>\n            <td>\n                <p>{{ frappe.utils.fmt_money(doc.grand_total | abs, None, doc.currency) }}</p>\n            </td>\n        </tr>\n    </table>\n</div>\n\n<div>\n<div class=\"text-center\">\n    {% if inv_additional_fields.qr_image_src %}\n        <img src=\"{{ inv_additional_fields.qr_image_src }}\" width=200 height=200>\n    {% else %}\n        <div class=\"text-center w-100\">\n            <p class=\"h2 text-danger\">{{ _(\"Error : No Qr code\") }}</p>\n        </div>\n    {% endif %}\n\n</div>\n\n{% else %}\n    <div style=\"display: none;\">{{ frappe.msgprint( title='Error', msg=_(\"Does not have active ZATCA Phase 2 Business Settings\"), indicator=\"red\" ) }}</div>\n    <div class=\"text-center w-100\">\n        <p class=\"h2 text-danger\">{{ doc.company }} : {{ _(\"Does not have active ZATCA Phase 2 Business Settings\") }}</p>\n    </div>\n{% endif %}\n\n",
 "idx": 0,
 "line_breaks": 0,
 "margin_bottom": 15.0,
 "margin_left": 15.0,
 "margin_right": 15.0,
 "margin_top": 15.0,
 "modified": "2024-11-14 13:29:27.743509",
 "modified_by": "Administrator",
 "module": "KSA Compliance",
 "name": "ZATCA Phase 2 Print Format",
 "owner": "Administrator",
 "page_number": "Hide",
 "print_format_builder": 0,
 "print_format_builder_beta": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}